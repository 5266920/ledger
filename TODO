LEDGER  -*- mode: org; fill-column: 78 -*-

#+STARTUP: content
#+SEQ_TODO: TODO(@) STARTED WAITING(@) DELEGATED(@) DEFERRED(@) | DONE(@) CANCELLED(@) WONTFIX(@) WORKSFORME INVALID(@) DUPLICATE(@) CLOSED TESTED NOTE
#+TAGS: LINK(l)
#+DRAWERS: PROPERTIES LOGBOOK OUTPUT SCRIPT SOURCE
#+CATEGORY: Ledger

* Bugs
  :PROPERTIES:
  :CATEGORY: Bugs
  :END:
** TODO --exchange seems to be ignored when combined with -M				 :ATTACH:
#+begin_src sh
  ledger  --exchange € reg ^dépenses|grep "\\$" |wc -l
#+end_src
  :OUTPUT:
  0
  :END:

#+begin_src sh
  ledger  --exchange € -M reg ^dépenses|grep "\\$" |wc -l
#+end_src
  :OUTPUT:
  14
  :END:
  :PROPERTIES:
  :ID:       03377560-850B-4258-B9A3-CE9BE7DAA70C
  :Submitter: Gabriel Kerneis <gabriel@kerneis.info>
  :Attachments: ledger.txt.gpg
  :END:
  [2010-01-18 Mon 03:42]
** TODO Bug with -J and multiple commodities						 :ATTACH:
#+begin_src sh
  ledger  --exchange € -M -J reg ^dépenses
#+end_src
  :OUTPUT:
  While evaluating value expression:
   quantity(scrub(display_total))
   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  Error: Cannot convert a balance with multiple commodities to an amount
  2009-11-01 168.71
  2009-11-01 256.81
  2009-11-01 275.56
  2009-11-01 326.46
  :END:
  I know this is intended behaviour, -J is not supposed to work with multiple
  commodities.  But --exchange should be able to make it work IMHO -- and it
  does it quite well without the -M flag.

  I think this might be related to some bugs reported recently in the
  mailing-list (it mentionned -J and multiple commodities too).
  :PROPERTIES:
  :ID:       68EAF363-D0FE-4127-866E-A5AEBACB65D6
  :Submitter: Gabriel Kerneis <gabriel@kerneis.info>
  :Attachments: ledger.txt.gpg
  :END:
  [2010-01-18 Mon 03:44]
** TODO [#C] Complain about mutually exclusive options (such as -M and -s)
#+begin_src sh
  ledger -M -s reg ^actifs
#+end_src
  Adding the -s option seems to break the -M one (instead of three months,
  there is a single "09-Nov-01 - 10-Jan-01" period).  In short, -s and -M
  can't be combined in ledger reg.
  :PROPERTIES:
  :ID:       3BC282AF-4C48-4D54-A156-C9840A80EFA1
  :Submitter: Gabriel Kerneis <gabriel@kerneis.info>
  :END:
  [2010-01-18 Mon 02:55]
** TODO The print command can generate unbalanced transactions				 :ATTACH:
#+begin_src sh
  ledger --exchange € print
#+end_src
  If some lines have a date different from the transaction one, they are
  splitted in two transaction, which does not balance.
  :OUTPUT:
  $ grep 6933954 ledger.txt
  2009/11/05 * (6933954) Hamou Jean-Pierre   

  $ ledger print|grep 6933954
  2009/11/05 * (6933954) Hamou Jean-Pierre
  2009/11/05 * (6933954) Hamou Jean-Pierre
  :END:
  :PROPERTIES:
  :ID:       34BD95B8-F5ED-431E-A4BD-02DA3DF66EAA
  :Submitter: Gabriel Kerneis <gabriel@kerneis.info>
  :Attachments: ledger.txt.gpg
  :END:
  [2010-01-18 Mon 02:56]
** TODO Divide by zero error using -A reg						 :ATTACH:
#+begin_src sh
  ledger --exchange € -A reg
#+end_src
  :OUTPUT:
  While evaluating value expression:
    (total_expr / count)
    ^^^^^^^^^^^^^^^^^^^^
  While evaluating value expression:
    justify(scrub(display_total), total_width, (((((4 + date_width) + payee_width) + account_width) + amount_width) + total_width), true, color)
  Error: Divide by zero
  :END:
  "ledger -A bal" works fine though.
  :PROPERTIES:
  :ID:       75A28597-4B64-4A2E-AF98-CB12AE92A8FE
  :Submitter: Gabriel Kerneis <gabriel@kerneis.info>
  :Attachments: ledger.txt.gpg
  :END:
  [2010-01-18 Mon 02:58]
** TODO Assertion failed using print --raw						 :ATTACH:
#+begin_src sh
  ledger --exchange € print --raw
#+end_src
  :OUTPUT:
  /usr/include/boost/optional/optional.hpp:587: typename boost::optional_detail::optional_base<T>::pointer_const_type boost::optional<T>::operator->() const [with T = ledger::position_t]:
  Assertion `this->is_initialized()' failed.
  core dumped
  :END:
  :PROPERTIES:
  :ID:       F1D4CC8F-8C3A-4075-9D38-75BDF1E0E9C5
  :Submitter: Gabriel Kerneis <gabriel@kerneis.info>
  :Attachments: ledger.txt.gpg
  :END:
  [2010-01-18 Mon 02:59]
** TODO Segfault using -M -A bal							 :ATTACH:
#+begin_src sh
  ledger --exchange € -M -A bal
#+end_src
  "ledger -M bal" and "ledger -A bal" both work fine.
  :PROPERTIES:
  :ID:       9A4FEA3B-6490-46D0-9839-C283C87FE8B4
  :Submitter: Gabriel Kerneis <gabriel@kerneis.info>
  :Attachments: ledger.txt.gpg
  :END:
  [2010-01-18 Mon 03:00]
** TODO Problem with price conversions and -V						   :LINK:
   :PROPERTIES:
   :ID:       6FC5D114-958D-493B-8879-6B9ED28224AB
   :Message:  [[message://a6e822eb-17e3-4ff3-8e41-25c1999fb871@h9g2000yqa.googlegroups.com][-V option]]
   :END:
   [2010-01-09 Sat 21:05]
** TODO Errors with using the -J option							   :LINK:
   :PROPERTIES:
   :ID:       7C44010B-BB26-4E5C-8800-EB2C11891C9D
   :Message:  [[message://916c6e83-4da6-4b7a-a035-d146908beabc@a15g2000yqm.googlegroups.com][-J option]]
   :END:
   [2010-01-09 Sat 21:05]
** TODO Problems compiling with python support on debian squeeze			   :LINK:
   :PROPERTIES:
   :ID:       0167EEB2-6D64-4387-8F1D-F464C699A047
   :Message:  [[message://20100104044948.GA14665@atom][problems compiling with python support on debian squeeze]]
   :END:
   [2010-01-09 Sat 21:07]
** TODO Strange libboost suffix on Debian Squeeze with acprep				   :LINK:
   :PROPERTIES:
   :ID:       758C04DB-FECD-41DD-9A7B-B12E394B7E22
   :Message:  [[message://4b41432bd68c7_6cc63f9b2badc2fc154@fe4.rs.github.com.tmail][{GitHub} docunext sent you a message]]
   :END:
   [2010-01-09 Sat 21:07]
** TODO Auto-remainder of setting an account's balance broken				   :LINK:
   :PROPERTIES:
   :ID:       5A8CB6B5-E888-4B6D-9916-6521ABA0A746
   :Message:  [[message://20100103125340.GA4886@kerneis.info][Auto-remainder of setting an account's balance broken]]
   :END:
   [2010-01-09 Sat 21:07]
** TODO Issue with reporting asset history and -j/-J					   :LINK:
   - Note taken on [2010-01-09 Sat 21:09] \\
     Further data on this problem: [[message://dff1fb891001021247r77677d2dr66a31e8a8bbd498c@mail.gmail.com][Re: reporting assets history]]
   :PROPERTIES:
   :ID:       9EB10714-36E9-4AA0-A8FB-E9CECA92F5A3
   :Message:  [[message://dff1fb891001011724i8f750a7wf3df7f2aa69d7cd6@mail.gmail.com][Re: reporting assets history]]
   :END:
   [2010-01-09 Sat 21:08]
** TODO Another rounding issue								   :LINK:
   :PROPERTIES:
   :ID:       1D275740-D1A6-42B7-BDE4-F2F85E30CE8E
   :Message:  [[message://541a7592-f815-4625-bd42-e1efa3b49b30@j5g2000yqm.googlegroups.com][Re: Another rounding issue]]
   :END:
   [2010-01-09 Sat 21:09]
** WAITING [#A] The --account option is not working for metadata			 :ATTACH:
   - State "WAITING"    from "STARTED"    [2010-01-18 Mon 02:40] \\
     This is working for me, but I want to confirm with Russell.
   :LOGBOOK:
   CLOCK: [2010-01-18 Mon 02:38]--[2010-01-18 Mon 02:40] =>  0:02
   :END:
#+begin_src sh
   ./ledger -f AISER0033.dat bal
#+end_src
   :OUTPUT:
              $10.44  Internal:Travel
              $44.24  Projects:Meals
             $-54.68  Source:Visa
--------------------
                   0
   :END:

#+begin_src sh
   ./ledger -f AISER0033.dat reg
#+end_src
   :OUTPUT:
09-Sep-27 HUDSON NEWS HOUSTN .. Source:Visa                  $-6.55       $-6.55
                                Projects:Meals                $6.55            0
09-Sep-27 PEET'S COFFEE & TEA.. Source:Visa                  $-2.44       $-2.44
                                Projects:Meals                $2.44            0
09-Sep-28 FUSIA NEW YORK, NY    Source:Visa                 $-15.25      $-15.25
                                Projects:Meals               $15.25            0
09-Sep-29 BALUCHI'S NEW YORK,.. Source:Visa                 $-20.00      $-20.00
                                Projects:Meals               $20.00            0
                                Source:Visa                 $-10.44      $-10.44
                                Internal:Travel              $10.44            0
   :END:

#+begin_src sh
   ./ledger -f AISER0033.dat bal '%ER=AISER0033'
#+end_src
   :OUTPUT:
              $44.24  Projects:Meals
             $-44.24  Source:Visa
--------------------
                   0
   :END:

#+begin_src sh
   ./ledger -f AISER0033.dat bal '%ER=AISER0036'
#+end_src
   :OUTPUT:
              $10.44  Internal:Travel
             $-10.44  Source:Visa
--------------------
                   0
   :END:

#+begin_src sh
   ./ledger -f AISER0033.dat bal '--account=tag("ER")'
#+end_src
   No output?!
   :PROPERTIES:
   :ID:       CB3FFE90-6C53-438C-8A87-4D7616782FAE
   :Attachments: russell-bug.zip.gpg bug.dat
   :END:
   [2010-01-04 Mon 16:57]
** TODO The option "-p this" no longer works
   :PROPERTIES:
   :ID:       14F7B5C7-1FAC-4750-B389-E9FAA7BB0B9B
   :END:
   [2009-12-29 Tue 16:07]
** TODO Scoping error with the account directive and included files		    :LINK:ATTACH:
   - Note taken on [2009-12-08 Tue 19:45] \\
     Mentioned in this e-mail: [[message://E53FE149-FD4B-43F1-9A01-4DC9BF138DF3@surryhill.net][Ledger Bugfixes]].
   :PROPERTIES:
   :ID:       F4A477E6-C4F6-43B1-ABCC-4DC325C2869A
   :Attachments: timelog.dat a.dat
   :END:
   [2009-12-08 Tue 19:45]
** TODO There is a bug with the new fixed rate feature				    :LINK:ATTACH:
   - Note taken on [2009-12-11 Fri 02:12] \\
     Javier [[message://92a1cace0912100848v3b6e81bfp332590a8057d73fe@mail.gmail.com][writes]]:

     I found that the problem is not related to the new "fixed" directive at all.

     After looking through the fixed-directive code I couldn't find any problems
     with it. I also noticed that the annotation details change between parsing
     time (when they are fine) and the amount::value() call.

     Then I changed all my fixed directives in the ledger file to {=$####} entries
     for all the foreign currencies (no "fixed" directive in the whole file) and
     the problem persisted!: some {=} entries used the wrong price from another {=}
     entry.

     I think the problem is somewhere between parsing and applying the algorithms
     (at least for -V reg) where the original post details seem to have changed. At
     least for ANNOTATION_PRICE_FIXATED entries. (I used printf's in parsing and in
     amount_t::value() to see the price change).

     This is the command i'm using: ./ledger -f multicurrency-no-fixed.ledger -V
     reg payable:jlopez

     I ran this with the master branch on ubuntu 64 bits.
   :PROPERTIES:
   :ID:       DC6AA45B-F714-4209-B0CC-E6CAFB75E50E
   :Message:  [[message://53ed3320-3d2d-46d8-8dd3-98b953e926fb@e7g2000vbi.googlegroups.com][Re: Multicurrency and reg problem]]
   :Attachments: multicurrency-no-fixed.ledger.zip multicurrency-fixed.ledger.zip
   :END:
   [2009-12-01 Tue 02:39]
** TODO Attached file should print out Unrealized Gains in the report			 :ATTACH:
   - Note taken on [2009-11-25 Wed 04:48] \\
     It should print out:
     :OUTPUT:
                        0  Assets
                 $-800.00    Brokerage
                  $800.00    Checking
                 $-100.00  Equity:Unrealized Gains
                  $100.00  Equity:Unrealized Losses
     --------------------
                        0
     :END:
     Once this is fixed, correct test/baseline/opt-unrealized.test.
   :PROPERTIES:
   :ID:       22AA1522-30A0-403F-B16A-B8F674AC9125
   :Attachments: bug.dat
   :END:
   [2009-11-25 Wed 04:47]
** TODO next_element should honor quoting
  To make this possible:
#+begin_src ledger
  P 2009/08/20 "FOO BAR" $2
#+end_src
  :PROPERTIES:
  :ID:       1D6EB807-6BFA-4C63-B993-930102A7AFF2
  :END:
  [2009-11-25 Wed 04:27]
** TODO sm is seeing a segfault with the register command				   :LINK:
   - Note taken on [2009-12-06 Sun 06:05] \\
     It happens on Leopard for me in a virtual machine.
   - Note taken on [2009-11-25 Wed 04:40] \\
     This is happening because boost::regex is constructing a bad object.
   :PROPERTIES:
   :ID:       46196FD4-B82B-4633-A728-94D0FFB65F69
   :Message:  [[message://hef2ir$tuh$1@ger.gmane.org][register segfault with recent build]]
   :END:
   [2009-11-24 Tue 22:13]
** TODO Another balance reporting bug, where the ordering is wrong			 :ATTACH:
   :PROPERTIES:
   :ID:       8026905D-42B6-40EE-AEBF-24ED0CC5DC53
   :Attachments: bug2.dat
   :END:
   [2009-11-24 Tue 03:08]
** TODO Bug when not using commodities in a posting's cost
   For example:
#+begin_src ledger
   2009/11/01 Sample
       Assets                1 apple {=0.10}
       Equity
#+end_src
   :PROPERTIES:
   :ID:       F29DE89C-73CD-4344-B6F7-BB7584AA6FFD
   :END:
   [2009-11-24 Tue 01:11]
* Features
  :PROPERTIES:
  :CATEGORY: Features
  :END:
** TODO Have a way to set the date range to "this week" easily				   :LINK:
   :PROPERTIES:
   :ID:       3ED8AC82-37A1-4513-AB20-8FFC66A2BD00
   :Message:  [[message://8017aec0-63c1-4d55-bced-5e87e50e7a8d@o28g2000yqh.googlegroups.com][Is there a way to set the date range to "this week" easily?]]
   :END:
   [2010-01-09 Sat 21:08]
** TODO Make the prices report use standard report query terms				   :LINK:
  The idea here is that report query filtering is done before the building up
  of commodities prices, so that you can see which commodities are involved
  with which reports:
#+begin_src sh
  ledger prices 'Lebensmittel:Milch'
  ledger prices '%kauf=leche'
#+end_src
  :PROPERTIES:
  :ID:       5229AE44-F390-4E4E-BAC6-674373CC775D
  :Message:  [[message://4B0E7757.1030607@gmail.com][How to type out a sales slip?]]
  :END:
  [2009-12-01 Tue 03:04]
** TODO lot_price should be able to return whether a commodity is "fixed rate"
   :PROPERTIES:
   :ID:       EF5442E5-4A83-45A5-98F8-DFEEF6F8AC6D
   :END:
   [2009-11-24 Tue 22:02]
** TODO Allow for period expressions "4 months ago" and "last 5 weeks"
   - State "TODO"       from "STARTED"    [2009-12-07 Mon 04:24]
   :PROPERTIES:
   :ID:       38B2FCC3-49E3-422D-8F90-03EF4A64382E
   :END:
   [2009-11-18 Wed 05:51]
* Emacs
  :PROPERTIES:
  :CATEGORY: Emacs
  :END:
* Python
  :PROPERTIES:
  :CATEGORY: Python
  :END:
* Build
  :PROPERTIES:
  :CATEGORY: Build
  :END:
** TODO acprep gives no warning about an unknown phase
   :PROPERTIES:
   :ID:       3FAC3387-9DCC-40AB-BE60-BA692E922F3F
   :END:
   [2009-12-06 Sun 06:03]
** TODO Create a PO file for Alexis to translate into German
   :PROPERTIES:
   :ID:       9D19729F-343C-464D-BE88-143C9DDA9394
   :END:
   [2009-11-09 Mon 03:40]
* Tests
  :PROPERTIES:
  :CATEGORY: Tests
  :END:
** TODO Read through Peter's accounting article, and make sure it all applies		 :ATTACH:
   :PROPERTIES:
   :ID:       72FC1715-E53C-4D4D-BF2C-514EB376DD19
   :Attachments: Tutorial%20on%20multiple%20currency%20accounting.pdf
   :END:
   [2009-11-24 Tue 22:04]
** TODO Rewrite the sample.dat file to be more realistic
   :PROPERTIES:
   :ID:       6E0F0FD6-38A2-4269-870F-41DE8B10D23C
   :END:
   [2009-11-20 Fri 18:31]
** TODO Use coverage analysis to determine if everything is being tested
   :PROPERTIES:
   :ID:       13E43A50-FC0C-4C3D-A175-7C6CB147A37C
   :END:
   [2008-08-14 Thu]
* Docs
  :PROPERTIES:
  :CATEGORY: Docs
  :END:
** TODO Remove --commodity-as-account from the man page and manual
   :PROPERTIES:
   :ID:       849EB210-BEEB-4FDE-A90C-688400D55ECE
   :END:
   [2009-12-29 Tue 16:07]
** TODO Fill out membership form for the Software Conservancy				   :LINK:
   :PROPERTIES:
   :ID:       78635C7A-98F2-494F-93A4-7CDA6094E681
   :Message:  [[message://4B240026.5040408@softwarefreedom.org][Re: Offer of membership to the Ledger project into the Software Freedom Conservancy, Inc.]]
   :END:
   [2009-12-17 Thu 02:44]
** TODO How to declare a statement reconciliation					 :ATTACH:
   :PROPERTIES:
   :ID:       32A4A048-886F-43FC-892E-EC125F372750
   :Attachments: foo.dat
   :END:
   [2009-12-10 Thu 18:05]
