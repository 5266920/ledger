#!/bin/sh

libtoolize -f
aclocal
autoheader
touch AUTHORS ChangeLog

if [ "$1" = "--dist" ]; then
    automake -acfi
else
    automake -acf
fi

autoconf

INCDIRS="-I/sw/include -I/usr/include/httpd/xml -I/sw/include/python2.3"
LIBFLAGS="-L/sw/lib"

if [ "$1" = "--boost" ]; then
    BOOST="-DUSE_BOOST_PYTHON=1 -Wno-long-double"
    shift
fi

if [ "$1" = "--debug" ]; then
    ./configure CPPFLAGS="$INCDIRS" LDFLAGS="$LIBFLAGS" \
	CXXFLAGS="-g $BOOST" --enable-debug --disable-shared
elif [ "$1" = "--opt" ]; then
    ./configure CPPFLAGS="$INCDIRS" LDFLAGS="$LIBFLAGS" \
	CXXFLAGS="-fomit-frame-pointer -fastf -mcpu=7450 -fPIC $BOOST" \
	--enable-standalone
elif [ "$1" = "--perf" ]; then
    ./configure CPPFLAGS="$INCDIRS" LDFLAGS="$LIBFLAGS" \
	CXXFLAGS="-g -pg $BOOST"
fi

rm AUTHORS ChangeLog
